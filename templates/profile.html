{% extends "base.html" %}
{% block content %}
{% import "macros/icons.html" as icons %}
{% include "header.html" %}

<div class="profile-container">

    <h4 class="mb-3">User profile</h4>

    <div class="cards-grid">
        <div class="card">
            <h5 class="card-title">User Information</h5>
            <div class="profile-info">
                <span class="profile-info-label">ID:</span>
                <span class="profile-info-value">***{{ user.id[-6:] }}</span>
            </div>
            <div class="profile-info">
                <span class="profile-info-label">Name:</span>
                <span class="profile-info-value">{{ user.full_name }}</span>
            </div>
            <div class="profile-info">
                <span class="profile-info-label">Email:</span>
                <span class="profile-info-value">{{ user.email | default("No email provided") }}</span>
            </div>
        </div>

        <div class="profile-card">
            <h5 class="profile-card-title">API connections</h5>
            <div class="zoom-linking-section">
                <div class="zoom-info">
                    <!-- <span class="zoom-icon"></span> -->
                    <span>Zoom API</span>
                </div>
                {% if is_zoom_linked %}
                <div class="link-status link-status--linked mb-3">
                    <span>Linked Account</span>
                    <span class="text-muted text-sm">ID: ***{{ user.zoom_user_id[-6:] }}</span>
                </div>

                <form action="/auth/zoom/unlink" method="POST"
                    onsubmit="return confirm('Are you sure you want to unlink your Zoom account?');">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                    <button type="submit" class="btn btn--danger btn--sm w-full">
                        Unlink Account
                    </button>
                </form>
                {% else %}
                <div class="link-status link-status--unlinked mb-3">
                    <span>Not Linked</span>
                </div>
                <a href="/auth/zoom" class="btn btn--primary w-full">
                    <span>Link Zoom Account</span>
                </a>
                {% endif %}
            </div>
        </div>

        {% if user.role == 'admin' %}
        <div class="profile-card">
            <h5 class="profile-card-title">Administration</h5>
            <a href="/admin/users" class="btn btn--primary">Manage Users</a>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}